<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head>
    <meta charset="utf-8">
<title>Xinkai Song&#39;s Homepage</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">


<meta name="description" content="Xinkai Song's blog about algorithm, programming, operating systems">



<meta name="keywords" content="Xinkai Song algorithm php golang">







<link rel="icon" href="/favicon.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/googlecode.min.css">

<link rel="stylesheet" href="/css/style.css">

<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>


    
    
    
    
    
    

    


</head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/">
                
                    
                    <img src="/images/home.png" alt="" height="28">
                    
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="/archives">Archives</a>
            
            <a class="navbar-item "
               href="/categories">Category</a>
            
            <a class="navbar-item "
               href="/categories/algorithm">Algorithm</a>
            
            <a class="navbar-item "
               href="/categories/note">Note</a>
            
            <a class="navbar-item "
               href="/about">About</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            <a class="navbar-item search" title="Search" href="javascript:;">
                <i class="fas fa-search"></i>
            </a>
            
            
            
        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    
        <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/2018/10/15/install-fastdfs.html" itemprop="url">安装FastDFS步骤</a>
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2018-10-15T13:13:10.000Z" itemprop="datePublished">Oct 15 2018</time>
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/FastDFS/">FastDFS</a>
        </span>
        
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <!-- toc -->
<ul>
<li><a href="#前言">前言</a></li>
<li><a href="#安装依赖libfastcommon">安装依赖libfastcommon</a></li>
<li><a href="#安装fastdfs">安装FastDFS</a></li>
<li><a href="#配置tracker">配置Tracker</a></li>
<li><a href="#配置fastdfs存储storage">配置FastDFS存储Storage</a></li>
<li><a href="#测试服务">测试服务</a></li>
</ul>
<!-- tocstop -->
<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>以下安装步骤在<code>CentOS 7.4.1708</code>上操作,项目git地址：</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/happyfish100/libfastcommon</span><br><span class="line">https://github.com/happyfish100/fastdfs</span><br></pre></td></tr></table></figure>
<h3 id="安装依赖libfastcommon"><a href="#安装依赖libfastcommon" class="headerlink" title="安装依赖libfastcommon"></a>安装依赖libfastcommon</h3><p>1.下载</p>
<p><code>wget https://github.com/happyfish100/libfastcommon/archive/V1.0.39.tar.gz</code></p>
<p>2.解压安装</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf  V1.0.39.tar.gz</span><br><span class="line">cd libfastcommon-1.0.39</span><br><span class="line">./make.sh</span><br><span class="line">./make.sh install</span><br></pre></td></tr></table></figure>
<p>3.安装文件目录如下：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/lib64/libfastcommon.so </span><br><span class="line">/lib64/libfdfsclient.so</span><br></pre></td></tr></table></figure>
        <p class="article-more-link">
            <a href="/2018/10/15/install-fastdfs.html#more">READ MORE</a>
        </p>
    
    </div>
    
    
</article>





    
        <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/2018/10/15/docker-without-sudo.html" itemprop="url">使用docker命令不需要sudo的方法</a>
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2018-10-15T09:17:45.000Z" itemprop="datePublished">Oct 15 2018</time>
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/docker/">docker</a>
        </span>
        
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <p>安装完使用<code>docker</code>命令默认是需要<code>sudo</code>权限的，因为访问<code>/var/run/docker.sock</code>需要<code>docker</code>组的用户权限，那么把当前用户加入<code>docker</code>组就可以了。</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo groupadd docker</span><br><span class="line">sudo gpasswd -a <span class="hljs-variable">$&#123;USER&#125;</span> docker</span><br><span class="line">sudo service docker restart</span><br><span class="line">newgrp - docker</span><br></pre></td></tr></table></figure>

    
    </div>
    
    
</article>





    
        <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/2016/03/28/download-android-sdk.html" itemprop="url">国内下载Android SDK方法</a>
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2016-03-28T07:40:00.000Z" itemprop="datePublished">Mar 28 2016</time>
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/note/">note</a>
        </span>
        
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <blockquote>
<p>国内下载Android SDK由于方某的科研成果导致无法下载。</p>
</blockquote>
<h3><span id="配置方法">配置方法</span></h3><ol>
<li>启动<code>Android SDK Manager</code>，打开<code>Tool-&gt;Options</code>找到<code>Android SDK Manager Settings</code>窗口。</li>
<li>在<code>Android SDK Manager Settings</code>窗口中，在<code>Http Proxy Server</code>和<code>Http Proxy Port</code>分辨输入<code>mirrors.neusoft.edu.cn</code>和<code>80</code>，并且选中<code>Force Https://....sources to be fetched using http://....</code>，设置完成后点击Close关闭<code>Android SDK Manager Settings</code> 窗口返回主界面。</li>
<li>然后你就发现，世界突然变得很美好了。PS:感谢东软提供的好东西。</li>
</ol>

    
    </div>
    
    
</article>





    
        <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/2016/03/23/mysql_transcation_isolation_level.html" itemprop="url">数据库事务隔离级别</a>
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2016-03-23T08:51:00.000Z" itemprop="datePublished">Mar 23 2016</time>
        </span>
        
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <blockquote>
<p>数据库的事务隔离级别从低到高有Read Uncommitted、Read Committed、Repeatable Read、Serialization</p>
</blockquote>
<h3 id="Read-Uncommitted-未提交读"><a href="#Read-Uncommitted-未提交读" class="headerlink" title="Read Uncommitted 未提交读"></a>Read Uncommitted 未提交读</h3><p>RU级别，事务中的修改即使没有提交，对别的事务也是可见的，别的事务可以读取未提交的数据，就会造成脏读，实际应用中很少用。</p>
<blockquote>
<p>eg. 脏读：小明今天发工资，公司财务把1w块钱打到小明的卡上，这时候并未提交事务，小明一查1w块，怎么比平时多了2000，很开始，后来财务发现这个问题，又撤销了事务，小明最后卡里没得到钱，白开心一场。</p>
</blockquote>
<h3 id="Read-Committed-提交读"><a href="#Read-Committed-提交读" class="headerlink" title="Read Committed 提交读"></a>Read Committed 提交读</h3><p>RC级别，只有事务提交的数据才对其他的事务可见，但是一个事务在处理过程中如果多次执行相同条件的查询的话可能读到不同的数据，因为在执行完第一次查询以后可能会有其他事务修改了数据，这称之为不可重复读。<br>RC解决了脏读的问题，大多数的数据库采用的默认级别都是RC。</p>
<blockquote>
<p>eg. 不可重复读：小明刚发了工资8000块，拿着工资卡去给老婆买礼物，2000元的衣服，刷卡的时候系统检测到小明的卡里有8000，这时候小明的老婆在网上偷偷把8000转到了余额宝，最后从小明卡里扣钱的时候提示扣款失败，小明就很郁闷明明有钱，这就是不可重复读的问题。<br></p></blockquote>
        <p class="article-more-link">
            <a href="/2016/03/23/mysql_transcation_isolation_level.html#more">READ MORE</a>
        </p>
    
    </div>
    
    
</article>





    
        <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/2016/03/18/filter_by_bit_operate.html" itemprop="url">位运算在条件过滤中的应用</a>
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2016-03-18T02:56:13.000Z" itemprop="datePublished">Mar 18 2016</time>
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/algorithm/">algorithm</a>
        </span>
        
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <blockquote>
<p>比如有一些用户资源，需要根据用户的属性条件过滤，条件如下：</p>
<ul>
<li>是否认证用户</li>
<li>用户手机平台</li>
</ul>
</blockquote>
<p>假设资源在MySQL中的存储表定义如下<br><figure class="highlight php hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">id int</span><br><span class="line">resource varchar</span><br><span class="line">flag int</span><br></pre></td></tr></table></figure></p>
<p>这儿<code>flag</code>是我定义的存储过滤条件的一个字段，对于条件值定义如下：<br><figure class="highlight php hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">FLAG_AUTH_YES = <span class="hljs-number">0x01</span>;  <span class="hljs-comment">//认证用户</span></span><br><span class="line">FLAG_AUTH_NO  = <span class="hljs-number">0x02</span>; <span class="hljs-comment">//未认证用户</span></span><br><span class="line">FLAG_AUTH_ALL = <span class="hljs-number">0x0F</span>;  <span class="hljs-comment">//不限制</span></span><br><span class="line"></span><br><span class="line">FLAG_OS_ANDROID = <span class="hljs-number">0x10</span>; <span class="hljs-comment">//Android</span></span><br><span class="line">FLAG_OS_IOS     = <span class="hljs-number">0x20</span>; <span class="hljs-comment">//iOS</span></span><br><span class="line">FLAG_OS_WP      = <span class="hljs-number">0x40</span>; <span class="hljs-comment">//WP</span></span><br><span class="line">FLAG_OS_ALL     = <span class="hljs-number">0xF0</span>; <span class="hljs-comment">//不限制</span></span><br></pre></td></tr></table></figure></p>
<p>根据定义我们知道，<code>flag</code>使用四位来存储一个条件，那么一个条件最多可以支持四种不同的情况。</p>
<h3 id="那么对于一条资源我们如何存储flag呢？"><a href="#那么对于一条资源我们如何存储flag呢？" class="headerlink" title="那么对于一条资源我们如何存储flag呢？"></a>那么对于一条资源我们如何存储<code>flag</code>呢？</h3><p>作按位与运算 ： <code>$flag = $auth | $os;</code><br>假设<code>$auth</code> 是<code>FLAG_AUTH_NO</code> 对应的二进制就是<code>0010</code>，<code>$os</code>是<code>FLAG_OS_IOS</code>对应的二进制是<code>0010 0000</code>，那么进行按位或以后flag的值就是<code>0010 0010</code>，对应的十进制就是34。</p>
<h3 id="在显示资源的列表的时候如何知道该资源的每个条件值呢？"><a href="#在显示资源的列表的时候如何知道该资源的每个条件值呢？" class="headerlink" title="在显示资源的列表的时候如何知道该资源的每个条件值呢？"></a>在显示资源的列表的时候如何知道该资源的每个条件值呢？</h3><p>对于上面存入的资源，我们可以使用<a href="http://baike.baidu.com/view/68.htm" title="掩码" target="_blank" rel="noopener">掩码</a>运算，对于<code>os</code>作按位与运算<br><code>$os = flag &amp; FLAG_OS_ALL</code>，这样我们就可以得到<code>0010 0000</code>也就是<code>FLAG_OS_IOS</code>。<br></p>
        <p class="article-more-link">
            <a href="/2016/03/18/filter_by_bit_operate.html#more">READ MORE</a>
        </p>
    
    </div>
    
    
</article>





    
        <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/2015/09/07/php-compile-configure-options.html" itemprop="url">PHP常用编译选项说明</a>
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2015-09-07T09:38:29.000Z" itemprop="datePublished">Sep 7 2015</time>
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/php/">php</a>
        </span>
        
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <h4><span id="编译选项">编译选项</span></h4><p>针对PHP的编译选项，可以参考PHP源码下面的<code>configure</code>文件，里面有详细的分类，下面挑选常用的选项作说明。</p>
<blockquote>
<p>在一个源代码下面如果有<code>configure</code>文件的话，可以使用<code>configure --help</code>查看编译选项。</p>
</blockquote>
<h4><span id="编译选项说明">编译选项说明</span></h4><ul>
<li>–prefix=/usr/local/php 指定php安装的路径</li>
<li>–with-config-file-path=xxx 指定php.ini文件的路径</li>
<li>–with-mysql=[DIR] DIR为MySQL安装根目录，添加MySQL支持</li>
<li>–with-mysql-sock  定位mysql的unix 套接字指针。如未指定，则按默认位置搜索</li>
<li>–with-mysqli=FILE 添加MySQLi支持，FILE是mysql_config文件的路径</li>
<li>–with-gd=[DIR]   添加GD库支持，DIR是GD库的根目录</li>
<li>–with-vpx-dir=DIR    GD相关 libvpx安装目录</li>
<li>–with-jpeg-dir=DIR   GD相关 libjpeg安装目录</li>
<li>–with-png-dir=DIR    GD相关 libpng安装目录</li>
<li>–with-zlib-dir=DIR    GD相关 libz安装目路</li>
<li>–with-xpm-dir=DIR   GD相关 libXpm安装目录</li>
<li>–with-freetype-dir=DIR  GD相关 FreeType 2安装目录</li>
<li>–disable-rpath  禁用传递其他的运行时库搜索路径</li>
<li>–enable-safe-mode  启用默认的安全模式 </li>
<li>–enable-fpm 启用php-fpm组件</li>
<li>–with-mcrypt=DIR 添加mcrypt支持，DIR为libmcrypt安装路径</li>
<li>–with-zlib 设置zlib的安装目录</li>
<li>–enable-mbstring 启用多字节字符串的支持</li>
<li>–with-openssl 启用openssl支持</li>
<li>–enable-pdo 添加pdo扩展支持</li>
<li>–with-pdo-mysql=[DIR] 添加对mysql的pdo支持，DIR为mysql的安装目录</li>
<li>–with-curl 添加curl扩展支持</li>
<li>–enable-sockets 启用Sockets支持</li>
<li>–enable-zip 启用zip支持</li>
</ul>

    
    </div>
    
    
</article>





    
    
    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2018 Xinkai Song&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            
        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("en-AU");
</script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        "HTML-CSS": {matchFontHeight: false},
        SVG: {matchFontHeight: false},
        CommonHTML: {matchFontHeight: false}
    });
</script>

    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof($.fn.justifiedGallery) === 'function') {
                $('.justified-gallery').justifiedGallery();
            }
        });
    })(jQuery);
</script>

    
    

    


<script src="/js/script.js"></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-mask"></div>
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js"></script>
    
</body>
</html>